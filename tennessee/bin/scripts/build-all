#!/bin/bash -e

function main() {
  cd "$(dirname "$0")" || { err "unable to change directory"; return 2; }

  local missingSetting
  missingSetting=false
  [[ "$TENANT" ]] || { err "Missing TENANT"; missingSetting=true; }
  [[ "$CLOUD" ]] || { err "Missing CLOUD"; missingSetting=true; }
  [[ "$GROUP" ]] || { err "Missing GROUP"; missingSetting=true; }
  "$missingSetting" && { err "Did you update and source settings?"; return 3; }

  err "building cloud"
  ../../cloud/build

  err "building group"
  ../../group/build

  err "building nashville"
  ../../nashville/build

  err "building memphis"
  ../../memphis/build

  err "building knoxville"
  ../../knoxville/build

  return 0
}

function err() { echo "$@" 1>&2; }

main "$@"
